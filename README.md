# ZAbbrevMaker
Tool to make better abbreviations for ZIL and the z-machine. Input is the zap-files that results from compiling the zil-files. Typical workflow for Zilf:

    zilf.exe game.zil
    del game_freq.zap
    ZAbbrevMaker.exe > game_freq.xzap
    zapf.exe game.zap
    
Typical workflow for Inform6 (be sure that your gamefile includes the file abbrevs.h or paste in them directly in the gamefile):

    inform6 -r $TRANSCRIPT_FORMAT=1 <game-path>\<game>.inf
    ZAbbrevMaker.exe -i > abbrevs.h
    inform6 -e $MAX_ABBREVS=96 <game-path>\<game>.inf
    
Precompiled binaries for linux-arm, linux-x64, osx-x64, win-x86, win-x64 & win-arm in the folder /ZAbbrevMaker/bin/SingleFile/.

## Instructions

    ZAbbrevMaker 0.3
    ZAbbrevMaker [switches] [path-to-game]
    
     -n nn        # of abbreviations to generate (default = 96).
     -l nn        Maxlength of abbreviations (default = 20).
                  and see if it gives better savings on account of z-chars rounding.
     -i           Generate output for Inform6. This requires that the file.
                  'gametext.txt' is in the gamepath. 'gametext.txt' is generated by:
                     inform6 -r $TRANSCRIPT_FORMAT=1 <game>.inf
                  in Inform6 version 6.35 or later. -i always use -r3.
     -d           Deep rounding. Try up yo 10,000 variants from discarded abbreviations
                  and see if it gives better savings on account of z-chars rounding.
     -df          Try deep rounding and then fast rounding, in that order (default).
     -fd          Try fast rounding and then deep rounding, in that order.
     -r3          Always round to 3 for fast and deep rounding. Normally rounding
                  to 6 is used for strings stored in high memory for z4+ games.
     -b           Throw all abbreviations that have lower score than last pick back on heap.
                  (This only occasionally improves the result, use sparingly.)
     -v           Verbose. Prints progress and intermediate results.
     path-to-game Use this path. If omitted the current path is used.
    
    ZAbbrevMaker executed without any switches in folder with zap-files is
    the same as 'ZAbbrevMaker -l 20 -df'.
    
## References
https://intfiction.org/t/highly-optimized-abbreviations-computed-efficiently/48753  
https://gitlab.com/russotto/zilabbrs  
https://github.com/hlabrand/retro-scripts  
https://www.nuget.org/packages/MoreComplexDataStructures/
